# HL-OS 功能测试清单

**版本**: v1.0.0
**测试日期**: ___________
**测试人员**: ___________

---

## 📋 测试说明

- ✅ 表示测试通过
- ❌ 表示测试失败
- ⚠️ 表示部分通过或存在问题
- N/A 表示不适用

**测试环境**:
- [ ] 开发环境 (localhost)
- [ ] 生产环境 (VPS)
- [ ] 移动设备类型: ___________ (例如: iPhone 13, Android平板)

---

## 🚀 第一部分：系统基础测试

### 1.1 服务启动检查

| 测试项 | 测试步骤 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| Docker容器启动 | `docker-compose ps` | 所有服务状态为 "Up" | ☐ | |
| 后端健康检查 | 访问 `http://localhost:8000/api/v1/health` | 返回 `{"status": "ok"}` | ☐ | |
| 前端访问 | 访问 `http://localhost:8501` | 正常显示主页 | ☐ | |
| API文档访问 | 访问 `http://localhost:8000/docs` | 显示Swagger文档 | ☐ | |
| Redis连接 | `docker-compose exec redis redis-cli ping` | 返回 "PONG" | ☐ | |
| AnythingLLM访问 | 访问 `http://localhost:3001` | 显示AnythingLLM界面 | ☐ | |

### 1.2 环境配置检查

| 测试项 | 测试步骤 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| API密钥配置 | 检查 `.env` 文件 | GOOGLE_AI_STUDIO_API_KEY 和 ANTHROPIC_API_KEY 已设置 | ☐ | |
| Obsidian目录 | 检查 `./obsidian_vault` | 目录存在且可写 | ☐ | |
| 上传目录 | 检查 `./uploads` | 目录存在且可写 | ☐ | |
| 备份目录 | 检查 `./backups` | 目录存在 | ☐ | |

---

## 📱 第二部分：前端界面测试（桌面端）

### 2.1 主页面 (app.py)

| 测试项 | 测试步骤 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| 页面加载 | 访问首页 | 显示"🎓 HL-OS 家庭智能学习系统" | ☐ | |
| 侧边栏显示 | 查看左侧边栏 | 显示导航菜单和系统状态 | ☐ | |
| 功能卡片 | 查看三个功能模块 | 显示"感知与校验"、"教学内容"、"评测引擎" | ☐ | |
| 统计数据 | 查看数据统计 | 显示4个指标（今日校验、错题本、知识卡片、完成课件） | ☐ | |
| 导航按钮 | 点击"开始"按钮 | 跳转到对应页面 | ☐ | |

### 2.2 作业校验页面 (1_📸_Validation.py)

| 测试项 | 测试步骤 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| 页面加载 | 点击侧边栏"作业校验" | 显示"📸 作业校验系统" | ☐ | |
| Tab切换 | 切换"上传"、"校验"、"历史"三个Tab | 正常切换无报错 | ☐ | |
| 侧边栏配置 | 输入孩子姓名、选择学科 | 配置正常保存 | ☐ | |
| 返回首页按钮 | 点击底部"返回首页" | 跳转回主页 | ☐ | |

### 2.3 教学内容生成页面 (2_📚_Content.py)

| 测试项 | 测试步骤 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| 页面加载 | 点击侧边栏"内容生成" | 显示"📚 教学内容生成系统" | ☐ | |
| 五个步骤显示 | 滚动查看页面 | 显示五个步骤的表单 | ☐ | |
| 知识点选择 | 切换"从错题本选择"和"自定义输入" | 表单正常切换 | ☐ | |
| 参数滑块 | 调整难度滑块 | 星级和文字描述正常更新 | ☐ | |
| 高级选项 | 展开"高级选项" | 显示RAG和额外要求配置 | ☐ | |

### 2.4 评测引擎页面 (3_📝_Assessment.py)

| 测试项 | 测试步骤 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| 页面加载 | 点击侧边栏"评测管理" | 显示"📝 评测引擎系统" | ☐ | |
| Tab切换 | 切换三个Tab | "生成题目"、"批改答案"、"学情分析"正常显示 | ☐ | |
| 范围配置 | 切换"按章节"、"按错题本"、"自定义" | 表单正常切换 | ☐ | |
| 难度分布输入 | 输入基础题、中档题、提高题数量 | 总题数正确计算 | ☐ | |
| 题型多选 | 选择多个题型 | 可多选 | ☐ | |

---

## 📱 第三部分：移动端适配测试

**测试设备**: ___________ (例如: iPhone 13, 屏幕宽度 390px)

### 3.1 响应式布局测试

| 测试项 | 测试步骤 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| 主页面布局 | 在移动设备打开主页 | 功能卡片垂直排列，统计数据2x2网格 | ☐ | |
| 侧边栏折叠 | 查看侧边栏 | 默认折叠，点击菜单图标可展开 | ☐ | |
| 按钮大小 | 点击各种按钮 | 按钮高度≥48px，易于点击 | ☐ | |
| 字体大小 | 查看页面文字 | 字体清晰可读，不需要缩放 | ☐ | |
| 图片显示 | 上传图片后查看 | 图片宽度适配屏幕，不溢出 | ☐ | |

### 3.2 触摸交互测试

| 测试项 | 测试步骤 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| 按钮点击反馈 | 点击任意按钮 | 有轻微缩小动画反馈 | ☐ | |
| 表单输入 | 点击输入框 | 键盘正常弹出，输入框不被遮挡 | ☐ | |
| 下拉选择 | 点击下拉菜单 | 选项列表完整显示 | ☐ | |
| 滑块操作 | 拖动难度滑块 | 滑块响应灵敏，准确 | ☐ | |
| 多选框 | 选择多个选项 | 可正常多选 | ☐ | |
| Expander展开 | 点击可折叠区域 | 内容正常展开/折叠 | ☐ | |

### 3.3 横屏/竖屏测试

| 测试项 | 测试步骤 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| 竖屏显示 | 竖屏浏览各页面 | 布局正常，无横向滚动 | ☐ | |
| 横屏显示 | 横屏浏览各页面 | 布局自适应，内容不变形 | ☐ | |
| 旋转切换 | 多次旋转设备 | 布局实时响应，无闪烁 | ☐ | |

---

## 🔧 第四部分：核心业务功能测试

### 4.1 模块A：感知与校验 - 图片上传与OCR

**测试数据准备**:
- 准备一张清晰的作业图片（建议分辨率 1920x1080 以上）
- 图片包含数学题目和学生手写答案

| 测试项 | 测试步骤 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| 图片上传 | 1. 进入"📸 作业校验"页面<br>2. 点击"📤 上传" Tab<br>3. 点击"选择图片文件"<br>4. 上传准备好的图片 | 图片正常显示预览 | ☐ | |
| 图片信息显示 | 展开"查看图片信息" | 显示文件名、大小、类型 | ☐ | |
| AI识别触发 | 点击"🚀 开始AI识别"按钮 | 显示"AI正在识别中"加载提示 | ☐ | |
| OCR结果返回 | 等待识别完成（30-60秒） | 显示"✅ 识别完成！任务ID: xxx" | ☐ | |
| 引导提示 | 查看页面提示 | 显示"请切换到 **✏️ 校验** 标签进行人工确认" | ☐ | |

**识别质量检查**:
- [ ] 题目文字识别准确率 > 95%
- [ ] 数学公式识别正确（如 x²、√、∫ 等）
- [ ] 手写数字识别清晰
- [ ] 标点符号识别正确

### 4.2 模块A：人工校验与保存

| 测试项 | 测试步骤 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| 切换到校验Tab | 点击"✏️ 校验" Tab | 显示AI识别结果和校验表单 | ☐ | |
| AI结果展示 | 查看识别文本区域 | 显示OCR识别的文本（只读） | ☐ | |
| 原始图片查看 | 展开"📸 查看原始图片" | 显示原始上传图片 | ☐ | |
| 文本修正 | 在"修正文本"框输入修正内容 | 可正常输入 | ☐ | |
| 元数据配置 | 1. 展开"元数据设置"<br>2. 调整难度等级<br>3. 选择标签<br>4. 输入知识点 | 所有配置可正常设置 | ☐ | |
| 保存位置选择 | 选择保存位置（已完成作业/错题本/知识卡片） | 下拉菜单正常 | ☐ | |
| 保存选项 | 勾选"保存到Obsidian"和"嵌入AnythingLLM" | 可正常勾选 | ☐ | |
| 提交保存 | 点击"✅ 确认并保存" | 显示"保存中..."加载提示 | ☐ | |
| 保存成功反馈 | 等待保存完成 | 显示"✅ 保存成功！"和气球动画 | ☐ | |
| Obsidian路径显示 | 查看保存结果 | 显示"📁 Obsidian: /path/to/file.md" | ☐ | |
| 嵌入状态显示 | 查看嵌入状态 | 显示"🔄 AnythingLLM 嵌入任务已加入队列" | ☐ | |

**数据验证**:
```bash
# 检查Obsidian文件是否创建
ls -la ./obsidian_vault/{孩子姓名}/{学科}/{分类}/

# 查看文件内容
cat ./obsidian_vault/{孩子姓名}/{学科}/{分类}/xxx.md

# 检查Frontmatter元数据
head -20 ./obsidian_vault/{孩子姓名}/{学科}/{分类}/xxx.md
```

- [ ] Obsidian文件已创建
- [ ] Frontmatter包含正确的元数据（Difficulty、Tags、Knowledge_Points等）
- [ ] 文件内容格式正确（Markdown格式）
- [ ] 图片路径正确（如有）

### 4.3 模块C：教学内容生成

**前置条件**: 已有至少一条错题记录（或准备自定义知识点）

| 测试项 | 测试步骤 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| 基本信息输入 | 1. 进入"📚 内容生成"页面<br>2. 输入孩子姓名<br>3. 选择学科 | 表单正常输入 | ☐ | |
| 知识点选择（错题本） | 1. 选择"从错题本选择"<br>2. 从列表中选择知识点 | 可多选知识点 | ☐ | |
| 知识点选择（自定义） | 1. 选择"自定义输入"<br>2. 输入知识点（每行一个） | 输入框正常，显示已选择数量 | ☐ | |
| 参数配置 | 1. 调整难度等级（1-5）<br>2. 选择教学风格<br>3. 设置目标时长 | 所有参数可调整 | ☐ | |
| 高级选项 | 1. 展开"高级选项"<br>2. 勾选"使用RAG检索教材内容"<br>3. 调整RAG检索数量<br>4. 输入额外要求 | 高级选项正常配置 | ☐ | |
| 生成内容触发 | 点击"🎨 生成教学内容" | 显示"Claude 正在生成教学内容"加载提示 | ☐ | |
| 生成完成 | 等待生成完成（60-120秒） | 显示"✅ 教学内容生成成功！" | ☐ | |
| 预览展示 | 查看"📄 内容预览"区域 | 显示元信息卡片（知识点数量、难度、风格、时长） | ☐ | |
| Marp内容查看 | 展开"📝 点击查看完整 Marp 源码" | 显示Marp格式的课件代码 | ☐ | |

**Marp内容质量检查**:
- [ ] 包含正确的Marp头部（marp: true, theme等）
- [ ] 分页符 `---` 使用正确
- [ ] 包含标题页、知识点讲解、例题、练习等结构
- [ ] 内容针对选择的知识点
- [ ] 难度符合设置
- [ ] 教学风格符合选择（启发式/费曼式等）

| 测试项 | 测试步骤 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| 修改建议输入 | 在"修改建议"框输入反馈 | 可正常输入 | ☐ | |
| 通过并保存 | 点击"✅ 通过并保存" | 显示"保存中..."加载提示 | ☐ | |
| 保存成功 | 等待保存完成 | 显示"✅ 已保存到 Obsidian: /path/to/file.md"和气球动画 | ☐ | |
| 预览清除 | 保存成功后 | 预览内容自动清除 | ☐ | |
| 拒绝功能 | 点击"❌ 拒绝"并输入原因 | 显示"已拒绝该内容"，预览清除 | ☐ | |

**数据验证**:
```bash
# 检查Obsidian课件文件
ls -la ./obsidian_vault/{孩子姓名}/{学科}/Courses/

# 查看课件内容
cat ./obsidian_vault/{孩子姓名}/{学科}/Courses/xxx.md
```

- [ ] 课件文件已保存到 `Courses/` 目录
- [ ] 文件包含完整的Marp内容
- [ ] Frontmatter元数据正确

### 4.4 模块D：评测引擎 - 题目生成

| 测试项 | 测试步骤 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| 基本信息输入 | 1. 进入"📝 评测管理"页面<br>2. 输入孩子姓名<br>3. 选择学科 | 表单正常输入 | ☐ | |
| 范围配置（按章节） | 1. 选择"按章节"<br>2. 多选章节 | 可多选章节 | ☐ | |
| 范围配置（按错题本） | 选择"按错题本" | 显示提示信息 | ☐ | |
| 范围配置（自定义） | 1. 选择"自定义"<br>2. 输入考察范围 | 输入框正常 | ☐ | |
| 难度分布设置 | 1. 输入基础题数量<br>2. 输入中档题数量<br>3. 输入提高题数量 | 总题数实时计算显示 | ☐ | |
| 题型选择 | 多选题型（选择题、填空题等） | 可多选 | ☐ | |
| 高级选项 | 1. 勾选"防搜索设计"<br>2. 勾选"包含详细解答" | 可正常勾选 | ☐ | |
| 生成题目触发 | 点击"🚀 生成题目" | 显示"Claude 正在生成原创题目"加载提示 | ☐ | |
| 生成完成 | 等待生成完成（60-120秒） | 显示"✅ 成功生成 X 道题目！" | ☐ | |
| 题目展示 | 查看"📄 生成的题目" | 显示所有题目的expander列表 | ☐ | |
| 题目详情查看 | 展开某道题目 | 显示题目内容、分值、知识点、详细解答 | ☐ | |
| 下载试卷 | 点击"📥 下载试卷（Markdown）" | 下载.md文件 | ☐ | |

**题目质量检查**:
- [ ] 题目数量正确（与设置的基础+中档+提高题数量一致）
- [ ] 题目类型符合选择
- [ ] 难度分布合理
- [ ] 题目内容原创（尝试搜索不应找到原题）
- [ ] 数学公式使用LaTeX格式
- [ ] 包含详细解答步骤
- [ ] 知识点标注正确

### 4.5 模块D：评测引擎 - 答案批改

**前置条件**: 已生成评测题目

**测试数据准备**: 准备一张学生手写答题的图片

| 测试项 | 测试步骤 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| Tab切换 | 切换到"批改答案" Tab | 显示当前评测信息 | ☐ | |
| 评测信息显示 | 查看页面 | 显示评测ID和题目数量 | ☐ | |
| 上传答题图片 | 上传学生答题图片 | 图片正常显示 | ☐ | |
| 开始批改 | 点击"🎯 开始批改" | 显示"正在识别答案并批改"加载提示 | ☐ | |
| 批改完成 | 等待批改完成（120-180秒） | 显示"✅ 批改完成！" | ☐ | |
| 总分显示 | 查看"📊 批改结果" | 显示4个指标（总分、准确率、错题数、正确数） | ☐ | |
| 逐题分析 | 查看"逐题分析" | 每道题显示得分、学生答案、反馈 | ☐ | |
| 正确题展示 | 查看正确的题目 | 绿色背景，显示学生答案 | ☐ | |
| 错误题展示 | 查看错误的题目 | 红色背景，显示学生答案、正确答案、批改反馈、改进建议 | ☐ | |
| 下载批改报告 | 点击"📥 下载批改报告" | 下载.md文件 | ☐ | |

**批改质量检查**:
- [ ] OCR识别学生手写答案准确率 > 90%
- [ ] 批改结果正确（对的给分，错的扣分）
- [ ] 批改反馈有针对性
- [ ] 改进建议合理
- [ ] 总分计算正确

### 4.6 模块D：学情分析

| 测试项 | 测试步骤 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| Tab切换 | 切换到"学情分析" Tab | 显示分析配置表单 | ☐ | |
| 基本信息 | 输入孩子姓名、选择学科 | 表单正常 | ☐ | |
| 筛选条件 | 1. 展开"筛选条件"<br>2. 调整最低难度<br>3. 调整最大准确率 | 滑块正常 | ☐ | |
| 生成分析 | 点击"📊 生成学情分析" | 显示"分析中..."加载提示 | ☐ | |
| 分析完成 | 等待分析完成 | 显示分析结果 | ☐ | |
| 总览显示 | 查看"总览" | 显示错题总数和整体准确率 | ☐ | |
| 知识点分布 | 查看"知识点掌握情况" | 显示表格（知识点、错题数、平均难度、平均准确率） | ☐ | |
| 薄弱知识点 | 查看"薄弱知识点" | 显示警告列表或"暂无明显薄弱点" | ☐ | |
| 复习建议 | 查看"复习建议" | 显示expander列表，每项包含知识点、优先级、原因、建议 | ☐ | |

---

## 🔗 第五部分：后端API测试

### 5.1 健康检查与基础API

```bash
# 健康检查
curl http://localhost:8000/api/v1/health

# 预期: {"status": "ok", "timestamp": "..."}
```

| API端点 | 测试命令 | 预期结果 | 状态 | 备注 |
|---------|---------|---------|------|------|
| GET /api/v1/health | `curl http://localhost:8000/api/v1/health` | 返回200，`{"status": "ok"}` | ☐ | |
| GET /docs | 访问API文档页面 | 显示Swagger UI | ☐ | |
| GET /redoc | 访问ReDoc文档 | 显示ReDoc UI | ☐ | |

### 5.2 模块A：感知与校验API

```bash
# 上传图片进行OCR
curl -X POST "http://localhost:8000/api/v1/perception/upload" \
  -F "file=@test_image.jpg" \
  -F "child_name=小明" \
  -F "subject=数学" \
  -F "content_type=homework"

# 预期: {"task_id": "xxx", "result": {...}}
```

| API端点 | 测试方法 | 预期结果 | 状态 | 备注 |
|---------|---------|---------|------|------|
| POST /api/v1/perception/upload | 上传图片文件 | 返回200，包含task_id和OCR结果 | ☐ | |
| POST /api/v1/validation/submit | 提交校验数据（JSON） | 返回200，包含obsidian_file_path | ☐ | |

**测试数据**:
```json
{
  "task_id": "从上传接口获得的task_id",
  "child_name": "小明",
  "subject": "数学",
  "folder_type": "Wrong_Problems",
  "corrected_content": "测试内容",
  "metadata": {
    "Difficulty": 3,
    "Tags": ["待复习"],
    "Knowledge_Points": ["二次函数"]
  },
  "save_to_obsidian": true,
  "embed_in_anythingllm": true
}
```

### 5.3 模块C：教学内容生成API

```bash
# 生成教学内容
curl -X POST "http://localhost:8000/api/v1/teaching/generate" \
  -H "Content-Type: application/json" \
  -d '{
    "child_name": "小明",
    "subject": "数学",
    "knowledge_points": ["二次函数顶点式"],
    "difficulty": 3,
    "style": "启发式",
    "duration_minutes": 30,
    "use_rag": true,
    "rag_top_k": 5
  }'

# 预期: {"preview_id": "xxx"}
```

| API端点 | 测试方法 | 预期结果 | 状态 | 备注 |
|---------|---------|---------|------|------|
| POST /api/v1/teaching/generate | 发送JSON配置 | 返回200，包含preview_id | ☐ | |
| GET /api/v1/teaching/preview/{id} | 获取预览 | 返回200，包含marp_content和元数据 | ☐ | |
| POST /api/v1/teaching/approve | 批准保存 | 返回200，包含obsidian_file_path | ☐ | |

### 5.4 模块D：评测引擎API

```bash
# 生成评测题目
curl -X POST "http://localhost:8000/api/v1/assessment/generate" \
  -H "Content-Type: application/json" \
  -d '{
    "child_name": "小明",
    "subject": "数学",
    "topic_range": ["二次函数"],
    "difficulty_distribution": {"1": 2, "3": 3, "5": 1},
    "question_types": ["选择题", "计算题"],
    "total_problems": 6,
    "prevent_search": true,
    "include_detailed_solution": true
  }'

# 预期: {"assessment_id": "xxx", "problems": [...]}
```

| API端点 | 测试方法 | 预期结果 | 状态 | 备注 |
|---------|---------|---------|------|------|
| POST /api/v1/assessment/generate | 发送配置 | 返回200，包含assessment_id和题目列表 | ☐ | |
| POST /api/v1/assessment/grade | 上传答题图片 | 返回200，包含批改结果 | ☐ | |
| POST /api/v1/assessment/analytics | 发送分析请求 | 返回200，包含学情分析数据 | ☐ | |

---

## 🗄️ 第六部分：数据持久化测试

### 6.1 Obsidian文件系统

| 测试项 | 测试步骤 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| 目录结构 | 完成一次完整流程后检查目录 | 存在 `/{孩子姓名}/{学科}/` 结构 | ☐ | |
| No_Problems文件 | 检查已完成作业目录 | 文件格式正确，包含Frontmatter | ☐ | |
| Wrong_Problems文件 | 检查错题本目录 | 文件格式正确，元数据完整 | ☐ | |
| Cards文件 | 检查知识卡片目录 | 文件格式正确 | ☐ | |
| Courses文件 | 检查课件目录 | Marp格式正确 | ☐ | |
| Frontmatter格式 | 使用python-frontmatter解析 | 所有元数据可正确解析 | ☐ | |
| 中文文件名 | 创建中文文件名 | 无乱码，可正常读写 | ☐ | |

**验证命令**:
```bash
# 查看目录结构
tree ./obsidian_vault

# 检查文件数量
find ./obsidian_vault -name "*.md" | wc -l

# 验证Frontmatter
python3 << EOF
import frontmatter
with open('./obsidian_vault/小明/数学/Wrong_Problems/xxx.md', 'r', encoding='utf-8') as f:
    post = frontmatter.load(f)
    print(post.metadata)
EOF
```

### 6.2 AnythingLLM嵌入

| 测试项 | 测试步骤 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| Workspace创建 | 完成一次保存后检查 | 在AnythingLLM界面看到新workspace | ☐ | |
| 文档嵌入 | 查看workspace文档列表 | 看到已嵌入的文档 | ☐ | |
| 向量搜索 | 在AnythingLLM中搜索关键词 | 能检索到相关文档 | ☐ | |
| 元数据保存 | 查看文档元数据 | 元数据正确保存 | ☐ | |

**验证方法**:
1. 访问 `http://localhost:3001`
2. 登录AnythingLLM
3. 查看Workspaces列表
4. 进入对应workspace
5. 查看Documents列表
6. 尝试搜索测试

### 6.3 Redis缓存

```bash
# 检查Redis连接
docker-compose exec redis redis-cli ping

# 查看所有键
docker-compose exec redis redis-cli KEYS "*"

# 查看某个键的值
docker-compose exec redis redis-cli GET "some_key"
```

| 测试项 | 测试命令 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| Redis连接 | `redis-cli ping` | 返回"PONG" | ☐ | |
| 缓存写入 | 执行需要缓存的操作后查看 | 相关键存在 | ☐ | |
| 缓存读取 | 重复执行相同操作 | 第二次更快（从缓存读取） | ☐ | |
| 缓存过期 | 等待超过TTL时间 | 键自动删除 | ☐ | |

---

## 🔄 第七部分：集成流程测试

### 7.1 完整业务流程：作业校验 → 错题本 → 生成微课

| 步骤 | 操作 | 预期结果 | 状态 | 备注 |
|-----|------|---------|------|------|
| 1 | 上传作业图片并识别 | OCR成功 | ☐ | |
| 2 | 人工校验并标记为错题 | 保存到Wrong_Problems/ | ☐ | |
| 3 | 验证Obsidian文件 | 文件存在，元数据正确 | ☐ | |
| 4 | 进入内容生成页面 | 页面加载正常 | ☐ | |
| 5 | 选择"从错题本选择"知识点 | 看到刚才的错题知识点 | ☐ | |
| 6 | 配置参数并生成微课 | Claude生成Marp课件 | ☐ | |
| 7 | 预览并批准 | 课件保存到Courses/ | ☐ | |
| 8 | 验证Obsidian课件文件 | 文件存在，Marp格式正确 | ☐ | |

### 7.2 完整业务流程：生成评测 → 批改 → 学情分析

| 步骤 | 操作 | 预期结果 | 状态 | 备注 |
|-----|------|---------|------|------|
| 1 | 配置评测范围和难度 | 配置成功 | ☐ | |
| 2 | 生成原创题目 | 生成10道题 | ☐ | |
| 3 | 下载试卷 | Markdown文件正确 | ☐ | |
| 4 | 上传学生答题图片 | 图片上传成功 | ☐ | |
| 5 | 自动批改 | 批改完成，结果正确 | ☐ | |
| 6 | 查看逐题分析 | 每道题反馈清晰 | ☐ | |
| 7 | 下载批改报告 | Markdown文件完整 | ☐ | |
| 8 | 切换到学情分析 | Tab切换成功 | ☐ | |
| 9 | 生成学情分析 | 分析结果合理 | ☐ | |
| 10 | 查看复习建议 | 建议有针对性 | ☐ | |

---

## ⚡ 第八部分：性能与稳定性测试

### 8.1 响应时间测试

| 测试项 | 操作 | 目标时间 | 实际时间 | 状态 | 备注 |
|--------|------|---------|---------|------|------|
| 页面加载 | 首次访问主页 | < 2秒 | _____秒 | ☐ | |
| 图片上传 | 上传10MB图片 | < 5秒 | _____秒 | ☐ | |
| OCR识别 | Gemini Vision处理 | < 60秒 | _____秒 | ☐ | |
| 内容生成 | Claude生成课件 | < 120秒 | _____秒 | ☐ | |
| 题目生成 | Claude生成10道题 | < 120秒 | _____秒 | ☐ | |
| 答案批改 | OCR+批改 | < 180秒 | _____秒 | ☐ | |

### 8.2 并发测试

| 测试项 | 测试方法 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| 多用户同时上传 | 3个用户同时上传图片 | 都能正常处理 | ☐ | |
| 多个生成任务 | 同时生成2个教学内容 | 队列处理，不报错 | ☐ | |
| 长时间运行 | 连续运行1小时 | 服务稳定，无内存泄漏 | ☐ | |

### 8.3 错误处理测试

| 测试项 | 触发方式 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| 上传超大图片 | 上传50MB图片 | 显示错误提示"文件过大" | ☐ | |
| 上传非图片文件 | 上传.txt文件 | 显示错误提示"文件格式不支持" | ☐ | |
| 网络中断 | 断开网络后操作 | 显示友好的错误提示 | ☐ | |
| API密钥错误 | 使用无效API密钥 | 显示错误提示 | ☐ | |
| 后端服务停止 | 停止backend容器 | 前端显示"无法连接到后端" | ☐ | |

---

## 🔒 第九部分：安全性测试

### 9.1 输入验证

| 测试项 | 测试方法 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| SQL注入 | 在文本框输入`' OR '1'='1` | 正常处理，不影响系统 | ☐ | |
| XSS攻击 | 输入`<script>alert('xss')</script>` | 自动转义，不执行脚本 | ☐ | |
| 路径遍历 | 输入`../../etc/passwd` | 阻止访问系统文件 | ☐ | |
| 命令注入 | 输入`; rm -rf /` | 不执行系统命令 | ☐ | |

### 9.2 权限与访问控制

| 测试项 | 测试方法 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| API访问 | 直接访问API（如未来有认证） | 需要认证 | ☐ | N/A（当前无认证） |
| 文件访问 | 尝试访问其他用户文件 | 拒绝访问 | ☐ | |
| 上传目录隔离 | 检查上传目录权限 | 只有应用可访问 | ☐ | |

---

## 🚀 第十部分：部署环境测试（生产环境）

**仅在VPS生产环境执行**

### 10.1 SSL/HTTPS

| 测试项 | 测试方法 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| HTTPS访问 | 访问 `https://yourdomain.com` | 正常显示，无证书警告 | ☐ | |
| HTTP重定向 | 访问 `http://yourdomain.com` | 自动跳转到HTTPS | ☐ | |
| 证书有效期 | 检查证书信息 | 有效期 > 30天 | ☐ | |
| SSL评分 | 使用 SSL Labs 测试 | 评分 A 或 A+ | ☐ | |

### 10.2 Nginx配置

| 测试项 | 测试方法 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| 反向代理 | 访问前端和API | 正常代理到对应服务 | ☐ | |
| 速率限制 | 短时间内频繁请求 | 触发429限制 | ☐ | |
| 文件上传大小 | 上传20MB文件 | 根据nginx配置正常上传 | ☐ | |
| Gzip压缩 | 检查响应头 | 包含`Content-Encoding: gzip` | ☐ | |

### 10.3 备份与恢复

```bash
# 执行备份
./docker/backup/backup.sh

# 验证备份文件
ls -lh ./backups/

# 测试恢复（谨慎！）
./docker/backup/restore.sh obsidian /app/backups/obsidian/xxx.tar.gz
```

| 测试项 | 测试方法 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| 手动备份 | 执行备份脚本 | 生成.tar.gz文件 | ☐ | |
| 备份文件完整性 | 解压备份文件 | 数据完整 | ☐ | |
| 恢复测试 | 恢复到新目录测试 | 数据正确恢复 | ☐ | |
| 定时备份 | 检查crontab配置 | 定时任务存在 | ☐ | |

### 10.4 监控与日志

```bash
# 查看容器状态
docker-compose ps

# 查看日志
docker-compose logs -f --tail=100

# 检查磁盘使用
df -h

# 检查内存使用
free -h
```

| 测试项 | 测试命令 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| 容器运行状态 | `docker-compose ps` | 所有容器状态"Up" | ☐ | |
| 日志正常输出 | `docker-compose logs` | 无ERROR级别日志 | ☐ | |
| 磁盘空间 | `df -h` | 可用空间 > 20% | ☐ | |
| 内存使用 | `free -h` | 可用内存 > 1GB | ☐ | |
| 系统负载 | `uptime` | Load average < CPU核心数 | ☐ | |

---

## 📊 测试总结

### 统计数据

- **总测试项**: _____ 项
- **通过**: _____ 项 (✅)
- **失败**: _____ 项 (❌)
- **部分通过**: _____ 项 (⚠️)
- **不适用**: _____ 项 (N/A)
- **通过率**: _____%

### 关键问题汇总

| 问题编号 | 模块 | 问题描述 | 严重级别 | 状态 | 备注 |
|---------|------|---------|---------|------|------|
| 1 | | | P0/P1/P2/P3 | | |
| 2 | | | | | |
| 3 | | | | | |

**严重级别说明**:
- **P0**: 阻塞性bug，系统无法使用
- **P1**: 严重bug，核心功能不可用
- **P2**: 一般bug，部分功能异常
- **P3**: 轻微bug，不影响使用

### 待改进项

1.
2.
3.

### 测试结论

- [ ] **通过** - 系统可以上线/交付
- [ ] **有条件通过** - 修复P0/P1问题后可上线
- [ ] **不通过** - 需要重大修改

### 测试人员签名

**测试人员**: ___________
**日期**: ___________
**签名**: ___________

---

## 📝 附录

### A. 测试环境信息

```bash
# 系统信息
uname -a

# Docker版本
docker --version
docker-compose --version

# Python版本（backend容器内）
docker-compose exec backend python --version

# Node版本（如需要）
node --version

# 磁盘空间
df -h

# 内存
free -h
```

**记录**:
```
系统: _____________________
Docker: __________________
Docker Compose: __________
磁盘可用: _______________
内存: ___________________
```

### B. 测试数据说明

**测试图片要求**:
- 分辨率: 1920x1080 或更高
- 格式: JPG或PNG
- 大小: < 10MB
- 内容: 清晰的手写作业/试卷
- 包含: 题目、答案、标注

**测试用例数据**:
- 孩子姓名: 小明、小红（多用户测试）
- 学科: 数学、英语（跨学科测试）
- 知识点: 二次函数、一元二次方程等

### C. 快速问题诊断

**问题**: 前端无法访问
```bash
# 检查容器状态
docker-compose ps frontend

# 查看日志
docker-compose logs frontend

# 检查端口
netstat -tlnp | grep 8501
```

**问题**: 后端API报错
```bash
# 查看后端日志
docker-compose logs backend | tail -100

# 进入容器检查
docker-compose exec backend bash
python -c "import anthropic; print('OK')"
```

**问题**: OCR识别失败
```bash
# 检查API密钥
docker-compose exec backend env | grep GOOGLE_AI_STUDIO_API_KEY

# 测试Gemini连接
docker-compose exec backend python -c "
import google.generativeai as genai
import os
genai.configure(api_key=os.getenv('GOOGLE_AI_STUDIO_API_KEY'))
print('OK')
"
```

**问题**: 文件保存失败
```bash
# 检查Obsidian目录权限
ls -la ./obsidian_vault

# 检查磁盘空间
df -h

# 测试写入
docker-compose exec backend touch /app/obsidian_vault/test.txt
```

---

**文档版本**: v1.0
**最后更新**: 2024-01-13
**联系方式**: [项目Issue页面]
